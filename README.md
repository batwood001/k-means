This code is terrible and not meant to be read by the general public (yet). :)
